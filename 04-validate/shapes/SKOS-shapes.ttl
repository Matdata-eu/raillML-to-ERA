@prefix sh:   <http://www.w3.org/ns/shacl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix era-sh: <http://data.europa.eu/949/shapes/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .

#################################################################
# 1) Every skos:Concept must have skos:inScheme
#################################################################

era-sh:SkosConcept_MustHaveInScheme
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:severity sh:Violation ;
    sh:property [
          sh:path skos:inScheme ;
          sh:minCount 1 ;
          sh:message "Every skos:Concept must have at least one skos:inScheme."@en ;
      ] .

#################################################################
# 2) If a Concept has no skos:broader, it must have skos:topConceptOf
#################################################################

era-sh:SkosConcept_TopConceptMustHaveTopConceptOf
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:severity sh:Violation ;
    sh:or (
      # Case A: concept has a broader -> ok
      [
          sh:property [
                          sh:path skos:broader ;
                          sh:minCount 1 ;
                      ]
      ]
      # Case B: concept is a top concept -> must have topConceptOf
      [
          sh:property [
                          sh:path skos:topConceptOf ;
                          sh:minCount 1 ;
                          sh:message "A skos:Concept without skos:broader must declare skos:topConceptOf (i.e., be linked to its ConceptScheme as a top concept)."@en ;
                      ]
      ]
      ) .

################################################
# 3) inScheme must point to a skos:ConceptScheme
################################################

era-sh:SkosConcept_InSchemeMustBeConceptScheme
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:severity sh:Violation ;
    sh:property [
          sh:path skos:inScheme ;
          sh:class skos:ConceptScheme ;
          sh:message "skos:inScheme must point to a resource typed as skos:ConceptScheme."@en ;
      ] .

@prefix sh:   <http://www.w3.org/ns/shacl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix era-sh: <http://data.europa.eu/949/shapes/> .
@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .

#################################################################
# 4) Every skos:Concept must have at least one skos:prefLabel
#################################################################

era-sh:SkosConcept_MustHavePrefLabel
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:property [
          sh:severity sh:Violation ;
          sh:path skos:prefLabel ;
          sh:minCount 1 ;
          sh:message "Every skos:Concept must have at least one skos:prefLabel."@en ;
      ] .

#################################################################
# 5) skos:Concept prefLabel should be a language-tagged literal (rdf:langString)
#    (use Warning so you can migrate legacy data gradually)
#################################################################

era-sh:SkosConcept_PrefLabelMustBeLangString
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:property [
          sh:severity sh:Violation ;
          sh:path skos:prefLabel ;
          sh:datatype rdf:langString ;
          sh:message "Every skos:Concept skos:prefLabel must be a language-tagged literal (rdf:langString)."@en ;
      ] .

#################################################################
# 6) A skos:Concept may have at most one skos:prefLabel per language
#################################################################

era-sh:SkosConcept_PrefLabelUniquePerLang
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:property [
          sh:severity sh:Violation ;
          sh:path skos:prefLabel ;
          sh:uniqueLang true ;
          sh:message "A skos:Concept must not have more than one skos:prefLabel with the same language tag."@en ;
      ] .

#################################################################
# 7) Every skos:ConceptScheme must have at least one skos:prefLabel
#################################################################

era-sh:SkosConceptScheme_MustHavePrefLabel
    a sh:NodeShape ;
    sh:targetClass skos:ConceptScheme ;
    sh:property [
          sh:severity sh:Violation ;
          sh:path skos:prefLabel ;
          sh:minCount 1 ;
          sh:message "Every skos:ConceptScheme must have at least one skos:prefLabel."@en ;
      ] .

#################################################################
# 8) skos:ConceptScheme prefLabel should be a language-tagged literal (rdf:langString)
#################################################################

era-sh:SkosConceptScheme_PrefLabelMustBeLangString
    a sh:NodeShape ;
    sh:targetClass skos:ConceptScheme ;
    sh:property [
          sh:severity sh:Violation ;
          sh:path skos:prefLabel ;
          sh:datatype rdf:langString ;
          sh:message "skos:ConceptScheme skos:prefLabel should be a language-tagged literal (rdf:langString)."@en ;
      ] .

#################################################################
# 9) A skos:ConceptScheme may have at most one skos:prefLabel per language
#################################################################

era-sh:SkosConceptScheme_PrefLabelUniquePerLang
    a sh:NodeShape ;
    sh:targetClass skos:ConceptScheme ;
    sh:property [
          sh:severity sh:Violation ;
          sh:path skos:prefLabel ;
          sh:uniqueLang true ;
          sh:message "A skos:ConceptScheme must not have more than one skos:prefLabel with the same language tag."@en ;
      ] .

#################################################################
# 10) skos:Concept altLabel should be a language-tagged literal (rdf:langString)
#################################################################

era-sh:SkosConcept_AltLabelMustBeLangString
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:property [
          sh:severity sh:Violation ;
          sh:path skos:altLabel ;
          sh:datatype rdf:langString ;
          sh:message "Every skos:Concept skos:altLabel must be a language-tagged literal (rdf:langString)."@en ;
      ] .
